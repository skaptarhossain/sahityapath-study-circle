rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Personal Auto Test Configs - Users can read/write their own configs
    match /personal-auto-test-configs/{configId} {
      allow read, write: if request.auth != null && request.auth.uid == resource.data.userId;
      allow create: if request.auth != null && request.auth.uid == request.resource.data.userId;
    }
    
    // Personal Courses
    match /personal-courses/{courseId} {
      allow read, write: if request.auth != null;
    }
    
    // Personal Topics
    match /personal-topics/{topicId} {
      allow read, write: if request.auth != null;
    }
    
    // Personal Content Items
    match /personal-content-items/{itemId} {
      allow read, write: if request.auth != null;
    }
    
    // Personal MCQs
    match /personal-mcqs/{mcqId} {
      allow read, write: if request.auth != null;
    }
    
    // Personal Question Categories
    match /personal-question-categories/{catId} {
      allow read, write: if request.auth != null;
    }
    
    // Personal Quiz Results
    match /personal-quiz-results/{resultId} {
      allow read, write: if request.auth != null;
    }
    
    // Personal Live Tests
    match /personal-live-tests/{testId} {
      allow read, write: if request.auth != null;
    }
    
    // Personal Live Test Results
    match /personal-live-test-results/{resultId} {
      allow read, write: if request.auth != null;
    }
    
    // Groups
    match /groups/{groupId} {
      allow read, write: if request.auth != null;
    }
    
    // Group Topics
    match /group-topics/{topicId} {
      allow read, write: if request.auth != null;
    }
    
    // Group Sub Topics
    match /group-subtopics/{subtopicId} {
      allow read, write: if request.auth != null;
    }
    
    // Group Content Items
    match /group-content-items/{itemId} {
      allow read, write: if request.auth != null;
    }
    
    // Group MCQs
    match /group-mcqs/{mcqId} {
      allow read, write: if request.auth != null;
    }
    
    // Group Question Categories
    match /group-question-categories/{catId} {
      allow read, write: if request.auth != null;
    }
    
    // Group Quiz Results
    match /group-quiz-results/{resultId} {
      allow read, write: if request.auth != null;
    }
    
    // Group Live Tests
    match /group-live-tests/{testId} {
      allow read, write: if request.auth != null;
    }
    
    // Group Live Test Results
    match /group-live-test-results/{resultId} {
      allow read, write: if request.auth != null;
    }
    
    // Asset Library
    match /asset-subjects/{subjectId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    match /asset-topics/{topicId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    match /asset-subtopics/{subtopicId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    match /assets/{assetId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // Users
    match /users/{userId} {
      allow read, write: if request.auth != null;
    }
    
    // Default: Allow authenticated users
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
  }
}
